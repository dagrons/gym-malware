import numpy as np
from sklearn.model_selection import train_test_split
from gym.envs.registration import register
import random

# get samples for environment
from gym_malware.envs.utils import interface_v2, pefeatures
sha256 = interface_v2.get_available_sha256()
# create a holdout set
np.random.seed(123)

sha256_train, sha256_holdout = train_test_split(sha256, test_size=0.2)


MAXTURNS = 50

register(
    id='malware-v0',
    entry_point='gym_malware.envs:MalwareEnv',
    kwargs={'random_sample': True, 'maxturns': MAXTURNS,
            'sha256list': sha256_train}
)

register(
    id='malware-test-v0',
    entry_point='gym_malware.envs:MalwareEnv',
    kwargs={'random_sample': False, 'maxturns': MAXTURNS,
            'sha256list': sha256_holdout}
)

register(
    id='malware-score-v0',
    entry_point='gym_malware.envs:MalwareScoreEnv',
    kwargs={'random_sample': True, 'maxturns': MAXTURNS,
            'sha256list': sha256_train}
)

register(
    id='malware-score-test-v0',
    entry_point='gym_malware.envs:MalwareScoreEnv',
    kwargs={'random_sample': False, 'maxturns': MAXTURNS,
            'sha256list': sha256_holdout}
)
