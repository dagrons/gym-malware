import numpy as np


MAXLEN = 1048576


class PEFeatureExtractor(object):
    """malconv extractor"""

    def __init__(self):
        self.padding_char = 256

    def extract(self, bytez):
        b = np.ones((1048576,), dtype=np.int16) * self.padding_char
        bytez = np.frombuffer(bytez[: 1048576], dtype=np.uint8)
        b[: len(bytez)] = bytez
        return b
